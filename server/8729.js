"use strict";var __defProp=Object.defineProperty,__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});exports.id=8729,exports.ids=[8729],exports.modules={68729:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>NbAuthModule});var _angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(37716),_angular_common__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(38583),_angular_router__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(10494),_angular_forms__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(3679),_nebular_theme__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(44265),_nebular_theme__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(32937),_nebular_theme__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(52313),_nebular_theme__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(48722),_nebular_theme__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(71147),_nebular_theme__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(60534),_nebular_theme__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(42687),_services_auth_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(15798),_services_token_token__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(93264),_services_token_token_storage__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(84399),_services_token_token_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(19822),_services_token_token_parceler__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(19339),_strategies_dummy_dummy_strategy__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(16721),_strategies_oauth2_oauth2_strategy__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9814),_strategies_password_password_strategy__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(67846),_auth_options__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69207),_helpers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(47852);function nbStrategiesFactory(options,injector){const strategies=[];return options.strategies.forEach(([strategyClass,strategyOptions])=>{const strategy=injector.get(strategyClass);strategy.setOptions(strategyOptions),strategies.push(strategy)}),strategies}function nbTokensFactory(strategies){const tokens=[];return strategies.forEach(strategy=>{tokens.push(strategy.getOption("token.class"))}),tokens}function nbOptionsFactory(options){return(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.ZB)(_auth_options__WEBPACK_IMPORTED_MODULE_1__.GI,options)}function nbNoOpInterceptorFilter(req){return!0}__name(nbStrategiesFactory,"nbStrategiesFactory"),__name(nbTokensFactory,"nbTokensFactory"),__name(nbOptionsFactory,"nbOptionsFactory"),__name(nbNoOpInterceptorFilter,"nbNoOpInterceptorFilter");class NbAuthModule{static forRoot(nbAuthOptions){return{ngModule:NbAuthModule,providers:[{provide:_auth_options__WEBPACK_IMPORTED_MODULE_1__.sR,useValue:nbAuthOptions},{provide:_auth_options__WEBPACK_IMPORTED_MODULE_1__.h,useFactory:nbOptionsFactory,deps:[_auth_options__WEBPACK_IMPORTED_MODULE_1__.sR]},{provide:_auth_options__WEBPACK_IMPORTED_MODULE_1__.ao,useFactory:nbStrategiesFactory,deps:[_auth_options__WEBPACK_IMPORTED_MODULE_1__.h,_angular_core__WEBPACK_IMPORTED_MODULE_2__.zs3]},{provide:_auth_options__WEBPACK_IMPORTED_MODULE_1__.oB,useFactory:nbTokensFactory,deps:[_auth_options__WEBPACK_IMPORTED_MODULE_1__.ao]},{provide:_services_token_token_parceler__WEBPACK_IMPORTED_MODULE_3__.Z,useValue:_services_token_token__WEBPACK_IMPORTED_MODULE_4__.xC},{provide:_auth_options__WEBPACK_IMPORTED_MODULE_1__.g5,useValue:"Authorization"},{provide:_auth_options__WEBPACK_IMPORTED_MODULE_1__.nN,useValue:nbNoOpInterceptorFilter},{provide:_services_token_token_storage__WEBPACK_IMPORTED_MODULE_5__.i,useClass:_services_token_token_storage__WEBPACK_IMPORTED_MODULE_5__.e},_services_token_token_parceler__WEBPACK_IMPORTED_MODULE_3__.r,_services_auth_service__WEBPACK_IMPORTED_MODULE_6__._,_services_token_token_service__WEBPACK_IMPORTED_MODULE_7__.L,_strategies_dummy_dummy_strategy__WEBPACK_IMPORTED_MODULE_8__.r,_strategies_password_password_strategy__WEBPACK_IMPORTED_MODULE_9__.O,_strategies_oauth2_oauth2_strategy__WEBPACK_IMPORTED_MODULE_10__.F]}}}__name(NbAuthModule,"NbAuthModule"),NbAuthModule.\u0275fac=__name(function(t){return new(t||NbAuthModule)},"NbAuthModule_Factory"),NbAuthModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_2__.oAB({type:NbAuthModule}),NbAuthModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_2__.cJS({imports:[[_angular_common__WEBPACK_IMPORTED_MODULE_11__.ez,_nebular_theme__WEBPACK_IMPORTED_MODULE_12__.B,_nebular_theme__WEBPACK_IMPORTED_MODULE_13__.z,_nebular_theme__WEBPACK_IMPORTED_MODULE_14__.M,_nebular_theme__WEBPACK_IMPORTED_MODULE_15__.P,_nebular_theme__WEBPACK_IMPORTED_MODULE_16__.n,_nebular_theme__WEBPACK_IMPORTED_MODULE_17__.T,_angular_router__WEBPACK_IMPORTED_MODULE_18__.Bz,_angular_forms__WEBPACK_IMPORTED_MODULE_19__.u5,_nebular_theme__WEBPACK_IMPORTED_MODULE_20__.K]]})},69207:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{GI:()=>defaultAuthOptions,h:()=>NB_AUTH_OPTIONS,sR:()=>NB_AUTH_USER_OPTIONS,ao:()=>NB_AUTH_STRATEGIES,oB:()=>NB_AUTH_TOKENS,g5:()=>NB_AUTH_INTERCEPTOR_HEADER,nN:()=>NB_AUTH_TOKEN_INTERCEPTOR_FILTER});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(37716);const socialLinks=[],defaultAuthOptions={strategies:[],forms:{login:{redirectDelay:500,strategy:"email",rememberMe:!0,showMessages:{success:!0,error:!0},socialLinks},register:{redirectDelay:500,strategy:"email",showMessages:{success:!0,error:!0},terms:!0,socialLinks},requestPassword:{redirectDelay:500,strategy:"email",showMessages:{success:!0,error:!0},socialLinks},resetPassword:{redirectDelay:500,strategy:"email",showMessages:{success:!0,error:!0},socialLinks},logout:{redirectDelay:500,strategy:"email"},validation:{password:{required:!0,minLength:4,maxLength:50},email:{required:!0},fullName:{required:!1,minLength:4,maxLength:50}}}},NB_AUTH_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular Auth Options"),NB_AUTH_USER_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular User Auth Options"),NB_AUTH_STRATEGIES=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular Auth Strategies"),NB_AUTH_TOKENS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular Auth Tokens"),NB_AUTH_INTERCEPTOR_HEADER=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular Simple Interceptor Header"),NB_AUTH_TOKEN_INTERCEPTOR_FILTER=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular Interceptor Filter")},47852:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{ZB:()=>deepExtend,hB:()=>getDeepFromObject,XE:()=>urlBase64Decode});const deepExtend=__name(function(...objects){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];const target=arguments[0],args=Array.prototype.slice.call(arguments,1);let val,src;return args.forEach(function(obj){"object"!=typeof obj||Array.isArray(obj)||Object.keys(obj).forEach(function(key){if(src=target[key],val=obj[key],val!==target)return"object"!=typeof val||null===val?void(target[key]=val):Array.isArray(val)?void(target[key]=deepCloneArray(val)):isSpecificValue(val)?void(target[key]=cloneSpecificValue(val)):"object"!=typeof src||null===src||Array.isArray(src)?void(target[key]=deepExtend({},val)):void(target[key]=deepExtend(src,val))})}),target},"deepExtend");function isSpecificValue(val){return val instanceof Date||val instanceof RegExp}function cloneSpecificValue(val){if(val instanceof Date)return new Date(val.getTime());if(val instanceof RegExp)return new RegExp(val);throw new Error("cloneSpecificValue: Unexpected situation")}function deepCloneArray(arr){const clone=[];return arr.forEach(function(item,index){"object"==typeof item&&null!==item?Array.isArray(item)?clone[index]=deepCloneArray(item):isSpecificValue(item)?clone[index]=cloneSpecificValue(item):clone[index]=deepExtend({},item):clone[index]=item}),clone}function getDeepFromObject(object={},name,defaultValue){const keys=name.split(".");let level=deepExtend({},object||{});return keys.forEach(k=>{level=level&&void 0!==level[k]?level[k]:void 0}),void 0===level?defaultValue:level}function urlBase64Decode(str){let output=str.replace(/-/g,"+").replace(/_/g,"/");switch(output.length%4){case 0:break;case 2:output+="==";break;case 3:output+="=";break;default:throw new Error("Illegal base64url string!")}return b64DecodeUnicode(output)}function b64decode(str){let output="";if((str=String(str).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let bs,buffer,bc=0,idx=0;buffer=str.charAt(idx++);~buffer&&(bs=bc%4?64*bs+buffer:buffer,bc++%4)?output+=String.fromCharCode(255&bs>>(-2*bc&6)):0)buffer="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(buffer);return output}function b64DecodeUnicode(str){return decodeURIComponent(Array.prototype.map.call(b64decode(str),c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join(""))}__name(isSpecificValue,"isSpecificValue"),__name(cloneSpecificValue,"cloneSpecificValue"),__name(deepCloneArray,"deepCloneArray"),__name(getDeepFromObject,"getDeepFromObject"),__name(urlBase64Decode,"urlBase64Decode"),__name(b64decode,"b64decode"),__name(b64DecodeUnicode,"b64DecodeUnicode")},42305:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{g:()=>NbAuthResult});class NbAuthResult{constructor(success,response,redirect,errors,messages,token=null){this.success=success,this.response=response,this.redirect=redirect,this.errors=[],this.messages=[],this.errors=this.errors.concat([errors]),errors instanceof Array&&(this.errors=errors),this.messages=this.messages.concat([messages]),messages instanceof Array&&(this.messages=messages),this.token=token}getResponse(){return this.response}getToken(){return this.token}getRedirect(){return this.redirect}getErrors(){return this.errors.filter(val=>!!val)}getMessages(){return this.messages.filter(val=>!!val)}isSuccess(){return this.success}isFailure(){return!this.success}}__name(NbAuthResult,"NbAuthResult")},15798:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>NbAuthService});var rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25917),rxjs_operators__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(88002),rxjs_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(43190),_auth_options__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(69207),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(37716),_token_token_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(19822);class NbAuthService{constructor(tokenService,strategies){this.tokenService=tokenService,this.strategies=strategies}getToken(){return this.tokenService.get()}isAuthenticated(){return this.getToken().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_0__.U)(token=>token.isValid()))}isAuthenticatedOrRefresh(){return this.getToken().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.w)(token=>token.getValue()&&!token.isValid()?this.refreshToken(token.getOwnerStrategyName(),token).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.w)(res=>res.isSuccess()?this.isAuthenticated():(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(!1))):(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(token.isValid())))}onTokenChange(){return this.tokenService.tokenChange()}onAuthenticationChange(){return this.onTokenChange().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_0__.U)(token=>token.isValid()))}authenticate(strategyName,data){return this.getStrategy(strategyName).authenticate(data).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.w)(result=>this.processResultToken(result)))}register(strategyName,data){return this.getStrategy(strategyName).register(data).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.w)(result=>this.processResultToken(result)))}logout(strategyName){return this.getStrategy(strategyName).logout().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.w)(result=>(result.isSuccess()&&this.tokenService.clear().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_0__.U)(()=>result)),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(result))))}requestPassword(strategyName,data){return this.getStrategy(strategyName).requestPassword(data)}resetPassword(strategyName,data){return this.getStrategy(strategyName).resetPassword(data)}refreshToken(strategyName,data){return this.getStrategy(strategyName).refreshToken(data).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.w)(result=>this.processResultToken(result)))}getStrategy(strategyName){const found=this.strategies.find(strategy=>strategy.getName()===strategyName);if(!found)throw new TypeError(`There is no Auth Strategy registered under '${strategyName}' name`);return found}processResultToken(result){return result.isSuccess()&&result.getToken()?this.tokenService.set(result.getToken()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_0__.U)(token=>result)):(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(result)}}__name(NbAuthService,"NbAuthService"),NbAuthService.\u0275fac=__name(function(t){return new(t||NbAuthService)(_angular_core__WEBPACK_IMPORTED_MODULE_3__.LFG(_token_token_service__WEBPACK_IMPORTED_MODULE_4__.L),_angular_core__WEBPACK_IMPORTED_MODULE_3__.LFG(_auth_options__WEBPACK_IMPORTED_MODULE_5__.ao))},"NbAuthService_Factory"),NbAuthService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_3__.Yz7({token:NbAuthService,factory:NbAuthService.\u0275fac})},19339:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>NB_AUTH_FALLBACK_TOKEN,r:()=>NbAuthTokenParceler});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(37716),_token__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(93264),_auth_options__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(69207);const NB_AUTH_FALLBACK_TOKEN=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.OlP("Nebular Auth Options");class NbAuthTokenParceler{constructor(fallbackClass,tokenClasses){this.fallbackClass=fallbackClass,this.tokenClasses=tokenClasses}wrap(token){return JSON.stringify({name:token.getName(),ownerStrategyName:token.getOwnerStrategyName(),createdAt:token.getCreatedAt().getTime(),value:token.toString()})}unwrap(value){let tokenClass=this.fallbackClass,tokenValue="",tokenOwnerStrategyName="",tokenCreatedAt=null;const tokenPack=this.parseTokenPack(value);return tokenPack&&(tokenClass=this.getClassByName(tokenPack.name)||this.fallbackClass,tokenValue=tokenPack.value,tokenOwnerStrategyName=tokenPack.ownerStrategyName,tokenCreatedAt=new Date(Number(tokenPack.createdAt))),(0,_token__WEBPACK_IMPORTED_MODULE_1__.P_)(tokenClass,tokenValue,tokenOwnerStrategyName,tokenCreatedAt)}getClassByName(name){return this.tokenClasses.find(tokenClass=>tokenClass.NAME===name)}parseTokenPack(value){try{return JSON.parse(value)}catch(e){}return null}}__name(NbAuthTokenParceler,"NbAuthTokenParceler"),NbAuthTokenParceler.\u0275fac=__name(function(t){return new(t||NbAuthTokenParceler)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(NB_AUTH_FALLBACK_TOKEN),_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_auth_options__WEBPACK_IMPORTED_MODULE_2__.oB))},"NbAuthTokenParceler_Factory"),NbAuthTokenParceler.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:NbAuthTokenParceler,factory:NbAuthTokenParceler.\u0275fac})},84399:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>NbTokenStorage,e:()=>NbTokenLocalStorage});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(37716),_token_parceler__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(19339);class NbTokenStorage{}__name(NbTokenStorage,"NbTokenStorage");class NbTokenLocalStorage extends NbTokenStorage{constructor(parceler){super(),this.parceler=parceler,this.key="auth_app_token"}get(){const raw=localStorage.getItem(this.key);return this.parceler.unwrap(raw)}set(token){const raw=this.parceler.wrap(token);localStorage.setItem(this.key,raw)}clear(){localStorage.removeItem(this.key)}}__name(NbTokenLocalStorage,"NbTokenLocalStorage"),NbTokenLocalStorage.\u0275fac=__name(function(t){return new(t||NbTokenLocalStorage)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.LFG(_token_parceler__WEBPACK_IMPORTED_MODULE_1__.r))},"NbTokenLocalStorage_Factory"),NbTokenLocalStorage.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__.Yz7({token:NbTokenLocalStorage,factory:NbTokenLocalStorage.\u0275fac})},19822:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>NbTokenService});var rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(26215),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(25917),rxjs_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(45435),rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(78345),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(37716),_token_storage__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(84399);class NbTokenService{constructor(tokenStorage){this.tokenStorage=tokenStorage,this.token$=new rxjs__WEBPACK_IMPORTED_MODULE_0__.X(null),this.publishStoredToken()}tokenChange(){return this.token$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_1__.h)(value=>!!value),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.B)())}set(token){return this.tokenStorage.set(token),this.publishStoredToken(),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(null)}get(){const token=this.tokenStorage.get();return(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(token)}clear(){return this.tokenStorage.clear(),this.publishStoredToken(),(0,rxjs__WEBPACK_IMPORTED_MODULE_3__.of)(null)}publishStoredToken(){this.token$.next(this.tokenStorage.get())}}__name(NbTokenService,"NbTokenService"),NbTokenService.\u0275fac=__name(function(t){return new(t||NbTokenService)(_angular_core__WEBPACK_IMPORTED_MODULE_4__.LFG(_token_storage__WEBPACK_IMPORTED_MODULE_5__.i))},"NbTokenService_Factory"),NbTokenService.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_4__.Yz7({token:NbTokenService,factory:NbTokenService.\u0275fac})},93264:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{ww:()=>NbAuthIllegalTokenError,P_:()=>nbAuthCreateToken,xC:()=>NbAuthSimpleToken,OS:()=>NbAuthJWTToken,FN:()=>NbAuthOAuth2Token,Xq:()=>NbAuthOAuth2JWTToken});var _helpers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(47852);class NbAuthToken{constructor(){this.payload=null}getName(){return this.constructor.NAME}getPayload(){return this.payload}}__name(NbAuthToken,"NbAuthToken");class NbAuthTokenNotFoundError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,new.target.prototype)}}__name(NbAuthTokenNotFoundError,"NbAuthTokenNotFoundError");class NbAuthIllegalTokenError extends Error{constructor(message){super(message),Object.setPrototypeOf(this,new.target.prototype)}}__name(NbAuthIllegalTokenError,"NbAuthIllegalTokenError");class NbAuthEmptyTokenError extends NbAuthIllegalTokenError{constructor(message){super(message),Object.setPrototypeOf(this,new.target.prototype)}}__name(NbAuthEmptyTokenError,"NbAuthEmptyTokenError");class NbAuthIllegalJWTTokenError extends NbAuthIllegalTokenError{constructor(message){super(message),Object.setPrototypeOf(this,new.target.prototype)}}function nbAuthCreateToken(tokenClass,token,ownerStrategyName,createdAt){return new tokenClass(token,ownerStrategyName,createdAt)}function decodeJwtPayload(payload){if(0===payload.length)throw new NbAuthEmptyTokenError("Cannot extract from an empty payload.");const parts=payload.split(".");if(3!==parts.length)throw new NbAuthIllegalJWTTokenError(`The payload ${payload} is not valid JWT payload and must consist of three parts.`);let decoded;try{decoded=(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.XE)(parts[1])}catch(e){throw new NbAuthIllegalJWTTokenError(`The payload ${payload} is not valid JWT payload and cannot be parsed.`)}if(!decoded)throw new NbAuthIllegalJWTTokenError(`The payload ${payload} is not valid JWT payload and cannot be decoded.`);return JSON.parse(decoded)}__name(NbAuthIllegalJWTTokenError,"NbAuthIllegalJWTTokenError"),__name(nbAuthCreateToken,"nbAuthCreateToken"),__name(decodeJwtPayload,"decodeJwtPayload");class NbAuthSimpleToken extends NbAuthToken{constructor(token,ownerStrategyName,createdAt){super(),this.token=token,this.ownerStrategyName=ownerStrategyName,this.createdAt=createdAt;try{this.parsePayload()}catch(err){if(!(err instanceof NbAuthTokenNotFoundError))throw err}this.createdAt=this.prepareCreatedAt(createdAt)}parsePayload(){this.payload=null}prepareCreatedAt(date){return date||new Date}getCreatedAt(){return this.createdAt}getValue(){return this.token}getOwnerStrategyName(){return this.ownerStrategyName}isValid(){return!!this.getValue()}toString(){return this.token?this.token:""}}__name(NbAuthSimpleToken,"NbAuthSimpleToken"),NbAuthSimpleToken.NAME="nb:auth:simple:token";class NbAuthJWTToken extends NbAuthSimpleToken{prepareCreatedAt(date){const decoded=this.getPayload();return decoded&&decoded.iat?new Date(1e3*Number(decoded.iat)):super.prepareCreatedAt(date)}parsePayload(){if(!this.token)throw new NbAuthTokenNotFoundError("Token not found. ");this.payload=decodeJwtPayload(this.token)}getTokenExpDate(){const decoded=this.getPayload();if(decoded&&!decoded.hasOwnProperty("exp"))return null;const date=new Date(0);return date.setUTCSeconds(decoded.exp),date}isValid(){return super.isValid()&&(!this.getTokenExpDate()||new Date<this.getTokenExpDate())}}__name(NbAuthJWTToken,"NbAuthJWTToken"),NbAuthJWTToken.NAME="nb:auth:jwt:token";const prepareOAuth2Token=__name(data=>{if("string"==typeof data)try{return JSON.parse(data)}catch(e){}return data},"prepareOAuth2Token");class NbAuthOAuth2Token extends NbAuthSimpleToken{constructor(data={},ownerStrategyName,createdAt){super(prepareOAuth2Token(data),ownerStrategyName,createdAt)}getValue(){return this.token.access_token}getRefreshToken(){return this.token.refresh_token}setRefreshToken(refreshToken){this.token.refresh_token=refreshToken}parsePayload(){if(!this.token)throw new NbAuthTokenNotFoundError("Token not found.");if(!Object.keys(this.token).length)throw new NbAuthEmptyTokenError("Cannot extract payload from an empty token.");this.payload=this.token}getType(){return this.token.token_type}isValid(){return super.isValid()&&(!this.getTokenExpDate()||new Date<this.getTokenExpDate())}getTokenExpDate(){return this.token.hasOwnProperty("expires_in")?new Date(this.createdAt.getTime()+1e3*Number(this.token.expires_in)):null}toString(){return JSON.stringify(this.token)}}__name(NbAuthOAuth2Token,"NbAuthOAuth2Token"),NbAuthOAuth2Token.NAME="nb:auth:oauth2:token";class NbAuthOAuth2JWTToken extends NbAuthOAuth2Token{parsePayload(){super.parsePayload(),this.parseAccessTokenPayload()}parseAccessTokenPayload(){const accessToken=this.getValue();if(!accessToken)throw new NbAuthTokenNotFoundError("access_token key not found.");this.accessTokenPayload=decodeJwtPayload(accessToken)}getAccessTokenPayload(){return this.accessTokenPayload}prepareCreatedAt(date){const payload=this.accessTokenPayload;return payload&&payload.iat?new Date(1e3*Number(payload.iat)):super.prepareCreatedAt(date)}isValid(){return this.accessTokenPayload&&super.isValid()}getTokenExpDate(){if(this.accessTokenPayload&&this.accessTokenPayload.hasOwnProperty("exp")){const date=new Date(0);return date.setUTCSeconds(this.accessTokenPayload.exp),date}return super.getTokenExpDate()}}__name(NbAuthOAuth2JWTToken,"NbAuthOAuth2JWTToken"),NbAuthOAuth2JWTToken.NAME="nb:auth:oauth2:jwt:token"},41854:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Y:()=>NbAuthStrategyOptions});class NbAuthStrategyOptions{}__name(NbAuthStrategyOptions,"NbAuthStrategyOptions")},95607:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>NbAuthStrategy});var _angular_common_http__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(91841),_helpers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(47852),_services_token_token__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(93264);class NbAuthStrategy{setOptions(options){this.options=(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.ZB)({},this.defaultOptions,options)}getOption(key){return(0,_helpers__WEBPACK_IMPORTED_MODULE_0__.hB)(this.options,key,null)}createToken(value,failWhenInvalidToken){const token=(0,_services_token_token__WEBPACK_IMPORTED_MODULE_1__.P_)(this.getOption("token.class"),value,this.getName());if(failWhenInvalidToken&&!token.isValid())throw new _services_token_token__WEBPACK_IMPORTED_MODULE_1__.ww("Token is empty or invalid.");return token}getName(){return this.getOption("name")}createFailResponse(data){return new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.Zn({body:{},status:401})}createSuccessResponse(data){return new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.Zn({body:{},status:200})}getActionEndpoint(action){const actionEndpoint=this.getOption(`${action}.endpoint`),baseEndpoint=this.getOption("baseEndpoint");return actionEndpoint?baseEndpoint+actionEndpoint:""}}__name(NbAuthStrategy,"NbAuthStrategy")},16721:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>NbDummyAuthStrategy});var of=__webpack_require__(25917),delay=__webpack_require__(71289),auth_strategy=__webpack_require__(95607),auth_result=__webpack_require__(42305),auth_strategy_options=__webpack_require__(41854),token=__webpack_require__(93264);class NbDummyAuthStrategyOptions extends auth_strategy_options.Y{constructor(){super(...arguments),this.token={class:token.xC},this.delay=1e3,this.alwaysFail=!1}}__name(NbDummyAuthStrategyOptions,"NbDummyAuthStrategyOptions");const dummyStrategyOptions=new NbDummyAuthStrategyOptions;var core=__webpack_require__(37716);class NbDummyAuthStrategy extends auth_strategy.D{constructor(){super(...arguments),this.defaultOptions=dummyStrategyOptions}static setup(options){return[NbDummyAuthStrategy,options]}authenticate(data){return(0,of.of)(this.createDummyResult(data)).pipe((0,delay.g)(this.getOption("delay")))}register(data){return(0,of.of)(this.createDummyResult(data)).pipe((0,delay.g)(this.getOption("delay")))}requestPassword(data){return(0,of.of)(this.createDummyResult(data)).pipe((0,delay.g)(this.getOption("delay")))}resetPassword(data){return(0,of.of)(this.createDummyResult(data)).pipe((0,delay.g)(this.getOption("delay")))}logout(data){return(0,of.of)(this.createDummyResult(data)).pipe((0,delay.g)(this.getOption("delay")))}refreshToken(data){return(0,of.of)(this.createDummyResult(data)).pipe((0,delay.g)(this.getOption("delay")))}createDummyResult(data){if(this.getOption("alwaysFail"))return new auth_result.g(!1,this.createFailResponse(data),null,["Something went wrong."]);try{const token2=this.createToken("test token",!0);return new auth_result.g(!0,this.createSuccessResponse(data),"/",[],["Successfully logged in."],token2)}catch(err){return new auth_result.g(!1,this.createFailResponse(data),null,[err.message])}}}__name(NbDummyAuthStrategy,"NbDummyAuthStrategy"),NbDummyAuthStrategy.\u0275fac=function(){let \u0275NbDummyAuthStrategy_BaseFactory;return __name(function(t){return(\u0275NbDummyAuthStrategy_BaseFactory||(\u0275NbDummyAuthStrategy_BaseFactory=core.n5z(NbDummyAuthStrategy)))(t||NbDummyAuthStrategy)},"NbDummyAuthStrategy_Factory")}(),NbDummyAuthStrategy.\u0275prov=core.Yz7({token:NbDummyAuthStrategy,factory:NbDummyAuthStrategy.\u0275fac})},97501:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{aW:()=>NbOAuth2ResponseType,sY:()=>NbOAuth2GrantType,rW:()=>NbOAuth2ClientAuthMethod,N2:()=>auth2StrategyOptions});var NbOAuth2ResponseType,NbOAuth2ResponseType2,NbOAuth2GrantType,NbOAuth2GrantType2,NbOAuth2ClientAuthMethod,NbOAuth2ClientAuthMethod2,_services_token_token__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(93264),_auth_strategy_options__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41854);(NbOAuth2ResponseType2=NbOAuth2ResponseType||(NbOAuth2ResponseType={})).CODE="code",NbOAuth2ResponseType2.TOKEN="token",(NbOAuth2GrantType2=NbOAuth2GrantType||(NbOAuth2GrantType={})).AUTHORIZATION_CODE="authorization_code",NbOAuth2GrantType2.PASSWORD="password",NbOAuth2GrantType2.REFRESH_TOKEN="refresh_token",(NbOAuth2ClientAuthMethod2=NbOAuth2ClientAuthMethod||(NbOAuth2ClientAuthMethod={})).NONE="none",NbOAuth2ClientAuthMethod2.BASIC="basic",NbOAuth2ClientAuthMethod2.REQUEST_BODY="request-body";class NbOAuth2AuthStrategyOptions extends _auth_strategy_options__WEBPACK_IMPORTED_MODULE_0__.Y{constructor(){super(...arguments),this.baseEndpoint="",this.clientId="",this.clientSecret="",this.clientAuthMethod=NbOAuth2ClientAuthMethod.NONE,this.redirect={success:"/",failure:null},this.defaultErrors=["Something went wrong, please try again."],this.defaultMessages=["You have been successfully authenticated."],this.authorize={endpoint:"authorize",responseType:NbOAuth2ResponseType.CODE,requireValidToken:!0},this.token={endpoint:"token",grantType:NbOAuth2GrantType.AUTHORIZATION_CODE,requireValidToken:!0,class:_services_token_token__WEBPACK_IMPORTED_MODULE_1__.FN},this.refresh={endpoint:"token",grantType:NbOAuth2GrantType.REFRESH_TOKEN,requireValidToken:!0}}}__name(NbOAuth2AuthStrategyOptions,"NbOAuth2AuthStrategyOptions");const auth2StrategyOptions=new NbOAuth2AuthStrategyOptions},9814:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>NbOAuth2AuthStrategy});var _angular_common_http__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(91841),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25917),rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(43190),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(88002),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5304),_nebular_theme__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(56722),_auth_strategy__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(95607),_services_token_token__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(93264),_services_auth_result__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(42305),_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(97501),_angular_core__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(37716),_angular_router__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(10494);class NbOAuth2AuthStrategy extends _auth_strategy__WEBPACK_IMPORTED_MODULE_0__.D{constructor(http,route,window){super(),this.http=http,this.route=route,this.window=window,this.redirectResultHandlers={[_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.aW.CODE]:()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(this.route.snapshot.queryParams).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.w)(params=>params.code?this.requestToken(params.code):(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!1,params,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[])))),[_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.aW.TOKEN]:()=>{const requireValidToken=this.getOption("authorize.requireValidToken");return(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(this.route.snapshot.fragment).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(fragment=>this.parseHashAsQueryParams(fragment)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(params=>params.error?new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!1,params,this.getOption("redirect.failure"),this.getOption("defaultErrors"),[]):new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!0,params,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(params,requireValidToken))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.K)(err=>{const errors=[];return err instanceof _services_token_token__WEBPACK_IMPORTED_MODULE_7__.ww?errors.push(err.message):errors.push("Something went wrong."),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!1,err,this.getOption("redirect.failure"),errors))}))}},this.redirectResults={[_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.aW.CODE]:()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(this.route.snapshot.queryParams).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(params=>!(!params||!params.code&&!params.error))),[_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.aW.TOKEN]:()=>(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(this.route.snapshot.fragment).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(fragment=>this.parseHashAsQueryParams(fragment)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(params=>!(!params||!params.access_token&&!params.error)))},this.defaultOptions=_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.N2}static setup(options){return[NbOAuth2AuthStrategy,options]}get responseType(){return this.getOption("authorize.responseType")}get clientAuthMethod(){return this.getOption("clientAuthMethod")}authenticate(data){return this.getOption("token.grantType")===_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.sY.PASSWORD?this.passwordToken(data.email,data.password):this.isRedirectResult().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.w)(result=>result?this.getAuthorizationResult():(this.authorizeRedirect(),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!0)))))}getAuthorizationResult(){const redirectResultHandler=this.redirectResultHandlers[this.responseType];if(redirectResultHandler)return redirectResultHandler.call(this);throw new Error(`'${this.responseType}' responseType is not supported,\n                      only 'token' and 'code' are supported now`)}refreshToken(token){const url=this.getActionEndpoint("refresh"),requireValidToken=this.getOption("refresh.requireValidToken");let headers=this.buildAuthHeader()||new _angular_common_http__WEBPACK_IMPORTED_MODULE_8__.WM;return headers=headers.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(url,this.buildRefreshRequestData(token),{headers}).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(res=>new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!0,res,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createRefreshedToken(res,token,requireValidToken))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.K)(res=>this.handleResponseError(res)))}passwordToken(username,password){const url=this.getActionEndpoint("token"),requireValidToken=this.getOption("token.requireValidToken");let headers=this.buildAuthHeader()||new _angular_common_http__WEBPACK_IMPORTED_MODULE_8__.WM;return headers=headers.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(url,this.buildPasswordRequestData(username,password),{headers}).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(res=>new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!0,res,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(res,requireValidToken))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.K)(res=>this.handleResponseError(res)))}authorizeRedirect(){this.window.location.href=this.buildRedirectUrl()}isRedirectResult(){return this.redirectResults[this.responseType].call(this)}requestToken(code){const url=this.getActionEndpoint("token"),requireValidToken=this.getOption("token.requireValidToken");let headers=this.buildAuthHeader()||new _angular_common_http__WEBPACK_IMPORTED_MODULE_8__.WM;return headers=headers.append("Content-Type","application/x-www-form-urlencoded"),this.http.post(url,this.buildCodeRequestData(code),{headers}).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.U)(res=>new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!0,res,this.getOption("redirect.success"),[],this.getOption("defaultMessages"),this.createToken(res,requireValidToken))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.K)(res=>this.handleResponseError(res)))}buildCodeRequestData(code){const params={grant_type:this.getOption("token.grantType"),code,redirect_uri:this.getOption("token.redirectUri"),client_id:this.getOption("clientId")};return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)))}buildRefreshRequestData(token){const params={grant_type:this.getOption("refresh.grantType"),refresh_token:token.getRefreshToken(),scope:this.getOption("refresh.scope"),client_id:this.getOption("clientId")};return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)))}buildPasswordRequestData(username,password){const params={grant_type:this.getOption("token.grantType"),username,password,scope:this.getOption("token.scope")};return this.urlEncodeParameters(this.cleanParams(this.addCredentialsToParams(params)))}buildAuthHeader(){if(this.clientAuthMethod===_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.rW.BASIC){if(this.getOption("clientId")&&this.getOption("clientSecret"))return new _angular_common_http__WEBPACK_IMPORTED_MODULE_8__.WM({Authorization:"Basic "+btoa(this.getOption("clientId")+":"+this.getOption("clientSecret"))});throw Error("For basic client authentication method, please provide both clientId & clientSecret.")}}cleanParams(params){return Object.entries(params).forEach(([key,val])=>!val&&delete params[key]),params}addCredentialsToParams(params){if(this.clientAuthMethod===_oauth2_strategy_options__WEBPACK_IMPORTED_MODULE_1__.rW.REQUEST_BODY){if(this.getOption("clientId")&&this.getOption("clientSecret"))return{...params,client_id:this.getOption("clientId"),client_secret:this.getOption("clientSecret")};throw Error("For request body client authentication method, please provide both clientId & clientSecret.")}return params}handleResponseError(res){let errors=[];return res instanceof _angular_common_http__WEBPACK_IMPORTED_MODULE_8__.UA?res.error.error_description?errors.push(res.error.error_description):errors=this.getOption("defaultErrors"):res instanceof _services_token_token__WEBPACK_IMPORTED_MODULE_7__.ww?errors.push(res.message):errors.push("Something went wrong."),(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!1,res,this.getOption("redirect.failure"),errors,[]))}buildRedirectUrl(){const params={response_type:this.getOption("authorize.responseType"),client_id:this.getOption("clientId"),redirect_uri:this.getOption("authorize.redirectUri"),scope:this.getOption("authorize.scope"),state:this.getOption("authorize.state"),...this.getOption("authorize.params")};return`${this.getActionEndpoint("authorize")}?${this.urlEncodeParameters(this.cleanParams(params))}`}parseHashAsQueryParams(hash){return hash?hash.split("&").reduce((acc,part)=>{const item=part.split("=");return acc[item[0]]=decodeURIComponent(item[1]),acc},{}):{}}urlEncodeParameters(params){return Object.keys(params).map(k=>`${encodeURIComponent(k)}=${encodeURIComponent(params[k])}`).join("&")}createRefreshedToken(res,existingToken,requireValidToken){const refreshedToken=this.createToken(res,requireValidToken);return!refreshedToken.getRefreshToken()&&existingToken.getRefreshToken()&&refreshedToken.setRefreshToken(existingToken.getRefreshToken()),refreshedToken}register(data){throw new Error("`register` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.")}requestPassword(data){throw new Error("`requestPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.")}resetPassword(data={}){throw new Error("`resetPassword` is not supported by `NbOAuth2AuthStrategy`, use `authenticate`.")}logout(){return(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)(new _services_auth_result__WEBPACK_IMPORTED_MODULE_4__.g(!0))}}__name(NbOAuth2AuthStrategy,"NbOAuth2AuthStrategy"),NbOAuth2AuthStrategy.\u0275fac=__name(function(t){return new(t||NbOAuth2AuthStrategy)(_angular_core__WEBPACK_IMPORTED_MODULE_9__.LFG(_angular_common_http__WEBPACK_IMPORTED_MODULE_8__.eN),_angular_core__WEBPACK_IMPORTED_MODULE_9__.LFG(_angular_router__WEBPACK_IMPORTED_MODULE_10__.gz),_angular_core__WEBPACK_IMPORTED_MODULE_9__.LFG(_nebular_theme__WEBPACK_IMPORTED_MODULE_11__.Q3))},"NbOAuth2AuthStrategy_Factory"),NbOAuth2AuthStrategy.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_9__.Yz7({token:NbOAuth2AuthStrategy,factory:NbOAuth2AuthStrategy.\u0275fac})},67846:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>NbPasswordAuthStrategy});var http=__webpack_require__(91841),of=__webpack_require__(25917),map=__webpack_require__(88002),catchError=__webpack_require__(5304),switchMap=__webpack_require__(43190),auth_result=__webpack_require__(42305),auth_strategy=__webpack_require__(95607),token=__webpack_require__(93264),auth_strategy_options=__webpack_require__(41854),helpers=__webpack_require__(47852);class NbPasswordAuthStrategyOptions extends auth_strategy_options.Y{constructor(){super(...arguments),this.baseEndpoint="/api/auth/",this.login={alwaysFail:!1,endpoint:"login",method:"post",requireValidToken:!0,redirect:{success:"/",failure:null},defaultErrors:["Login/Email combination is not correct, please try again."],defaultMessages:["You have been successfully logged in."]},this.register={alwaysFail:!1,endpoint:"register",method:"post",requireValidToken:!0,redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully registered."]},this.requestPass={endpoint:"request-pass",method:"post",redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Reset password instructions have been sent to your email."]},this.resetPass={endpoint:"reset-pass",method:"put",redirect:{success:"/",failure:null},resetPasswordTokenKey:"reset_password_token",defaultErrors:["Something went wrong, please try again."],defaultMessages:["Your password has been successfully changed."]},this.logout={alwaysFail:!1,endpoint:"logout",method:"delete",redirect:{success:"/",failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["You have been successfully logged out."]},this.refreshToken={endpoint:"refresh-token",method:"post",requireValidToken:!0,redirect:{success:null,failure:null},defaultErrors:["Something went wrong, please try again."],defaultMessages:["Your token has been successfully refreshed."]},this.token={class:token.xC,key:"data.token",getter:(module,res,options)=>(0,helpers.hB)(res.body,options.token.key)},this.errors={key:"data.errors",getter:(module,res,options)=>(0,helpers.hB)(res.error,options.errors.key,options[module].defaultErrors)},this.messages={key:"data.messages",getter:(module,res,options)=>(0,helpers.hB)(res.body,options.messages.key,options[module].defaultMessages)}}}__name(NbPasswordAuthStrategyOptions,"NbPasswordAuthStrategyOptions");const passwordStrategyOptions=new NbPasswordAuthStrategyOptions;var core=__webpack_require__(37716),router=__webpack_require__(10494);class NbPasswordAuthStrategy extends auth_strategy.D{constructor(http2,route){super(),this.http=http2,this.route=route,this.defaultOptions=passwordStrategyOptions}static setup(options){return[NbPasswordAuthStrategy,options]}authenticate(data){const method=this.getOption("login.method"),url=this.getActionEndpoint("login"),requireValidToken=this.getOption("login.requireValidToken");return this.http.request(method,url,{body:data,observe:"response"}).pipe((0,map.U)(res=>{if(this.getOption("login.alwaysFail"))throw this.createFailResponse(data);return res}),(0,map.U)(res=>new auth_result.g(!0,res,this.getOption("login.redirect.success"),[],this.getOption("messages.getter")("login",res,this.options),this.createToken(this.getOption("token.getter")("login",res,this.options),requireValidToken))),(0,catchError.K)(res=>this.handleResponseError(res,"login")))}register(data){const module="register",method=this.getOption("register.method"),url=this.getActionEndpoint(module),requireValidToken=this.getOption("register.requireValidToken");return this.http.request(method,url,{body:data,observe:"response"}).pipe((0,map.U)(res=>{if(this.getOption("register.alwaysFail"))throw this.createFailResponse(data);return res}),(0,map.U)(res=>new auth_result.g(!0,res,this.getOption("register.redirect.success"),[],this.getOption("messages.getter")(module,res,this.options),this.createToken(this.getOption("token.getter")("login",res,this.options),requireValidToken))),(0,catchError.K)(res=>this.handleResponseError(res,module)))}requestPassword(data){const module="requestPass",method=this.getOption(`${module}.method`),url=this.getActionEndpoint(module);return this.http.request(method,url,{body:data,observe:"response"}).pipe((0,map.U)(res=>{if(this.getOption(`${module}.alwaysFail`))throw this.createFailResponse();return res}),(0,map.U)(res=>new auth_result.g(!0,res,this.getOption(`${module}.redirect.success`),[],this.getOption("messages.getter")(module,res,this.options))),(0,catchError.K)(res=>this.handleResponseError(res,module)))}resetPassword(data={}){const module="resetPass",method=this.getOption("resetPass.method"),url=this.getActionEndpoint(module),tokenKey=this.getOption("resetPass.resetPasswordTokenKey");return data[tokenKey]=this.route.snapshot.queryParams[tokenKey],this.http.request(method,url,{body:data,observe:"response"}).pipe((0,map.U)(res=>{if(this.getOption("resetPass.alwaysFail"))throw this.createFailResponse();return res}),(0,map.U)(res=>new auth_result.g(!0,res,this.getOption("resetPass.redirect.success"),[],this.getOption("messages.getter")(module,res,this.options))),(0,catchError.K)(res=>this.handleResponseError(res,module)))}logout(){const method=this.getOption("logout.method"),url=this.getActionEndpoint("logout");return(0,of.of)({}).pipe((0,switchMap.w)(res=>url?this.http.request(method,url,{observe:"response"}):(0,of.of)(res)),(0,map.U)(res=>{if(this.getOption("logout.alwaysFail"))throw this.createFailResponse();return res}),(0,map.U)(res=>new auth_result.g(!0,res,this.getOption("logout.redirect.success"),[],this.getOption("messages.getter")("logout",res,this.options))),(0,catchError.K)(res=>this.handleResponseError(res,"logout")))}refreshToken(data){const module="refreshToken",method=this.getOption(`${module}.method`),url=this.getActionEndpoint(module),requireValidToken=this.getOption(`${module}.requireValidToken`);return this.http.request(method,url,{body:data,observe:"response"}).pipe((0,map.U)(res=>{if(this.getOption(`${module}.alwaysFail`))throw this.createFailResponse(data);return res}),(0,map.U)(res=>new auth_result.g(!0,res,this.getOption(`${module}.redirect.success`),[],this.getOption("messages.getter")(module,res,this.options),this.createToken(this.getOption("token.getter")(module,res,this.options),requireValidToken))),(0,catchError.K)(res=>this.handleResponseError(res,module)))}handleResponseError(res,module){let errors=[];return res instanceof http.UA?errors=this.getOption("errors.getter")(module,res,this.options):res instanceof token.ww?errors.push(res.message):errors.push("Something went wrong."),(0,of.of)(new auth_result.g(!1,res,this.getOption(`${module}.redirect.failure`),errors))}}__name(NbPasswordAuthStrategy,"NbPasswordAuthStrategy"),NbPasswordAuthStrategy.\u0275fac=__name(function(t){return new(t||NbPasswordAuthStrategy)(core.LFG(http.eN),core.LFG(router.gz))},"NbPasswordAuthStrategy_Factory"),NbPasswordAuthStrategy.\u0275prov=core.Yz7({token:NbPasswordAuthStrategy,factory:NbPasswordAuthStrategy.\u0275fac})},48722:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>NbAlertModule});var _shared_shared_module__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(65131),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(37716);class NbAlertModule{}__name(NbAlertModule,"NbAlertModule"),NbAlertModule.\u0275fac=__name(function(t){return new(t||NbAlertModule)},"NbAlertModule_Factory"),NbAlertModule.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.oAB({type:NbAlertModule}),NbAlertModule.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.cJS({imports:[[_shared_shared_module__WEBPACK_IMPORTED_MODULE_1__.P]]})}};